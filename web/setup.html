<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Git CTF Admin Panel</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, inital-scale=1">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" crossorigin="anonymous">
        <link rel="stylesheet" href="/css/softsec.css">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <!-- Navbar ** This needs to be copied across all files** -->
        <nav class="navbar navbar-expand-md">
            <a class="navbar-brand" href="/index.html">
                <img src="/images/softsec.png" alt="Git CTF Logo" width="100" height="50">
            </a>
            <div class="collapse navbar-collapse justify-content-end">
                <a class="btn btn-secondary nav-link" href="/"><i class="fas fa-home"></i> Home</a>
                <a class="btn btn-secondary nav-link" href="/setup.html"><i class="fas fa-plus-circle"></i> Start New CTF</a>
                <a class="btn btn-secondary nav-link" href="/manage.html"><i class="fas fa-edit"></i> Manage Existing CTF</a>
            </div>
        </nav>

        <!-- Body -->
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <h1>Setup</h1>
                    <p>
                        This is the setup page for the Git CTF. Please
                        <a href="https://github.com/organizations/plan">create a new organization in Github</a>
                        and then paste the URL of the organization into the box below.),
                        and then copy the name of the organization into the form below. Please make this the
                        URL version (with no spaces) of the organization name.
                    </p>
                </div>
            </div>
            <form class="row form-horizontal needs-validation" action="/setup-form" method="POST" id="make-ctf-form" default>
                <div class="form-group d-none">
                    <input type="text" name="timezone-offset" id="timezone-offset">
                </div>
                <div class="form-group">
                    <label class="form-label" for="org-name"><i class="fas fa-hotel"></i> Organization Name</label>
                    <input type="text" class="form-control" id="org-name" name="org-name" placeholder="Organization Name" required>
                </div>
                <div class="form-group date">
                    <label class="form-label" for="start-date"></i> &nbsp; <i class="fas fa-calendar-alt"></i> Date to start then CTF</label>
                    <input id="start-date" name="start-date" class="form-control" type="date" required/>
                </div>
                <div class="form-group">
                    <label class="form-label" for="start-time"><i class="fas fa-clock"></i> Time to start then CTF</label>
                    <input id="start-time" name="start-time" class="form-control time" type="time" required/>
                </div>
                <div class="form-group date">
                    <label class="form-label" for="end-date"></i> &nbsp; <i class="fas fa-calendar-alt"></i> Date to end the CTF</label>
                    <input id="end-date" name="end-date" class="form-control" type="date" required/>
                </div>
                <div class="form-group">
                    <label class="form-label" for="end-time"><i class="fas fa-clock"></i> Time to end the CTF</label>
                    <input id="end-time" name="end-time" class="form-control" type="time" required/>
                </div>
                <div class="form-group">
                    <label for="base-image" class="form-label"></i> &nbsp; <i class="fas fa-life-ring"></i> Base Docker Image</label>
                    <input type="text" class="form-control" id="base-image" name="base-image" placeholder="ubuntu:latest" required>
                </div>
                <div class="form-group">
                    <label class="form-label" for="number-of-teams"></i> &nbsp; <i class="fas fa-users"></i> Number of Teams</label>
                    <input type="number" class="form-control" id="number-of-teams" name="number-of-teams" required placeholder="4">
                </div>
                <div class="form-group">
                    <label class="form-label" for="port-number"></i> &nbsp; <i class="fas fa-cogs"></i> Port Number</label>
                    <input type="number" class="form-control" id="port-number" name="port-number" required placeholder="2000">
                </div>
                <div class="form-group">
                    <label class="form-label" for="number-of-bugs"></i> &nbsp; <i class="fas fa-bug"></i> Number of Bugs</label>
                    <input type="number" class="form-control" id="number-of-bugs" name="number-of-bugs" required placeholder="4">
                </div>
                <div class="form-group">
                    <label class="form-label" for="service-name"></i> &nbsp; <i class="fas fa-align-justify"></i> Type of service</label>
                    <select id="service-name" name="service-name" class="form-control" required>
                        <option value="stand-alone" selected>stand-alone</option>
                        <option value="xinitd">xinitd</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" for="packages"><i class="fas fa-cubes"></i> Required Packages</label>
                    <input type="text" class="form-control" id="packages" name="packages" placeholder="sudo">
                </div>
                <div class="form-group">
                    <label class="form-label" for="sed-cmd"><i class="fas fa-terminal"></i> Custom Mirror sh command</label>
                    <input type="text" class="form-control" id="sed-cmd" name="sed-cmd" placeholder="sed -i 's/deb.debian.org/ftp.yourmirror.com/g' /etc/apt/sources.list">
                </div>
                <div class="form-group">
                    <label class="form-label" for="bin-args"><i class="fas fa-cubes"></i> Custom Binary Arguments</label>
                    <input type="text" class="form-control" id="bin-args" name="bin-args" placeholder="--arg1 --arg2">
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button type="submit" class="btn btn-success">Submit</button>
                    </div>
                </div>
            </form>
        </div>
    </body>
    <script>
        Date.prototype.stdTimezoneOffset = function () {
            var jan = new Date(this.getFullYear(), 0, 1);
            var jul = new Date(this.getFullYear(), 6, 1);
            return Math.max(jan.getTimezoneOffset(), jul.getTimezoneOffset());
        }
        let offset = new Date().stdTimezoneOffset()/60;
        let offset_text = (offset > 0) ? "+" : "-";
        if (offset > 10) {
            offset_text += "0";
        }
        offset_text += offset + ":00";
        $("#timezone-offset").val(offset_text);
        $('#make-ctf-form')[0].addEventListener("submit", function(event){
            if (!confirm('Are you sure this is correct?'))
            {
                e.preventDefault();
                return false;
            }
        });
    </script>
</html>